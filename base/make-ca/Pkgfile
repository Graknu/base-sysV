name=make-ca
description="Certificate Authority certificates, the Public Key Infrastructure."
packager=rems
version=0.8
source=(http://download.yaolinux.org/sources-base/make-ca-0.8.tar.gz
        http://download.yaolinux.org/sources-base/certdata.txt
        http://download.yaolinux.org/sources-base/root.crt
        http://download.yaolinux.org/sources-base/class3.crt
        )

prepare(){
    cd $name-$version
}

build(){
        install -vdm755 $PKG/{usr/sbin,etc/ssl/local}
        openssl x509 -in root.crt -text -fingerprint -setalias "CAcert Class 1 root" \
                -addtrust serverAuth -addtrust emailProtection -addtrust codeSigning \
                > /etc/ssl/local/CAcert_Class_1_root.pem
        openssl x509 -in class3.crt -text -fingerprint -setalias "CAcert Class 3 root" \
                -addtrust serverAuth -addtrust emailProtection -addtrust codeSigning \
                > /etc/ssl/local/CAcert_Class_3_root.pem
        cp certdata.txt $PKG/etc/ssl
        make DESTDIR=$PKG install
        $PKG/usr/sbin/make-ca.sh -D $PKG
}
