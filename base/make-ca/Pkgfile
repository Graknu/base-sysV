name=make-ca
description="Certificate Authority certificates, the Public Key Infrastructure."
packager=rems
version=0.7
source=(https://github.com/djlucas/$name/archive/v$version/$name-$version.tar.gz
     root.crt class3.crt)

prepare(){
    cd $name-$version
}

build(){
        install -vdm755 $PKG/{usr/sbin,etc/ssl/local}
        openssl x509 -in root.crt -text -fingerprint -setalias "CAcert Class 1 root" \
                -addtrust serverAuth -addtrust emailProtection -addtrust codeSigning \
                > /etc/ssl/local/CAcert_Class_1_root.pem
        openssl x509 -in class3.crt -text -fingerprint -setalias "CAcert Class 3 root" \
                -addtrust serverAuth -addtrust emailProtection -addtrust codeSigning \
                > /etc/ssl/local/CAcert_Class_3_root.pem
        cp certdata.txt $PKG/etc/ssl
        make DESTDIR=$PKG install
        $PKG/usr/sbin/make-ca.sh -D $PKG
}